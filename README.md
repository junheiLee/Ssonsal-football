# football
play data final project

## 공지할 내용

- 구장 예약증을 반드시 확인하세요.
- 게임이 끝난 후, 함께 승패를 기입하세요.
    - 상호 간의 승패 기입이 완료돼야 승점이 부과되므로 기입 여부를 현장에서 확인하세요.
- 팀 한줄 소개 입력 시,
    - 해당 소개는 상대 팀, 용병 혹은 팀원을 구할 때 보여지는 소개입니다.
    - 추가적으로 팀에 대한 정보나, 특이 사항을 입력해 주세요.

## Main

### 게임 카테고리

---

🟢 default: 팀원일 때 → for team, 회원일 때 → for sub

## 회원 관련

### 회원 가입, 로그인, 로그 아웃

---

- 🔴  회원은 소셜로그인을 통해 회원가입 및 로그인할 수 있다.
    - 소셜로그인을 진행했을때 해당 유저정보가 이미 존재하면 로그인으로 없으면 회원가입 페이지로 이동한다.
- 🔴  회원은 로그 아웃을 할 수 있다.

### 회원 정보

---

- 🟡 최초 로그인 시, 회원은 기타 정보를 입력할 수 있다.
    - 유저가 입력해야 하는 정보
        
        ```json
        {
            "age": "1998", //나이 : integer(올해년도에서 입력한 출생년도를 뺴서 산출) 
            "userPreferredTime": "주말 오후",  //선호 시간 : char(html select로 입력받음)
        		"userPreferredArea": "경기도",  //선호 지역 : char(html select로 입력받음)
            "position": "올라운더", //포지션 : char(html select로 입력받음)
        		"gender": "남" // 성별 : char(html select로 입력받음)
        }
        ```
        
- 🟡 회원이 입력한 기타 정보, 소셜을 통해 얻은 정보, 로직에서의 추가 정보를 저장한다.
    - 소셜을 통해 얻은 정보
        
        ```json
        {
            "email": "@naver.com",
            "name": "김정훈",
        }
        ```
        
    - 로직 에서의 추가 정보
        - createdAt: jpa 사용
        - manner_score, skill_score
            - ~~ex. review 수가 0인 경우 ‘-’ 로 표시한다.~~
        - role
    

- 🟡 회원은 본인의 기타 정보를 수정할 수 있다.
    - 회원 본인인 경우, 수정하기 버튼이 보인다.
    - ~~성별(최초 1회)~~
    

- 🟢 :특정 정보를 비공개로 설정할 수 있다.
    - 구현방법 구상중

- 🟡 다른 회원의 정보를 확인할 수 있다.
    - 기타 정보
    - 용병 참여 이력(평점 및 리뷰)
    - 팀에 소속된 회원일 경우 팀 정보
    
- 🟡 팀 정보를 확인할 수 있다
    - team_member 테이블에서 user_id를 조회해 없으면 팀 구하기 종용
    - team_member 테이블에서 user_id를 조회해 team_id를 가져온다.

## 팀 관련
### 팀 등록, 신청 및 탈퇴

---

- 🟥  일반 회원은 팀 등록을 통해 팀에 소속될 수 있다.
    - 기입해야 할 정보
        
        ```json
        {
            "teamName":"팀이름",
        	  "teamLogo":"팀로고",
        	  "teamPreferredArea":"팀선호지역", //format:
        	  "teamPreferredTime":"팀선호시간", //format:
          	"teamRecruit":"팀모집여부", //0: 모집 하지 않음, 1: 모집 중 
          	"teamIntro":"팀소개글",
        }
        ```
        
    - 로직에서 추가할 정보
        - team_leader_id
        - created_at
        - team_manner_score, team skill_score
        - team_record 테이블(승점, 승, 무, 패, 총 경기 수 0)
        - team_member에 팀장 row 추가
    - 등록하기 버튼을 누르면 DB에 등록한다.

- 🟥  회원은 팀 가입 신청을 통해 팀에 소속될 수 있다.
    - team_recruit column으로 신청 가능한 팀이 구분 된다.
    - **팀 상세 페이지**의 신청 버튼을 누를 경우, team_apply 테이블에 row가 추가된다.
    - 필요 정보를 로그인한 사용자의 정보와 현재페이지의 값을 이용해 넘긴다
    → 로그인한 사용자 정보: 닉네임,성별,나이,userid,포지션 // 현재페이지의 teamId값
    

- 🔴 팀에 소속된 팀원은 해당 팀에서 탈퇴할 수 있다.
    - 팀장은 탈퇴할 수 없다. (팀장이 null 값이 되거나, 다른 팀의 팀원이 팀장이 되는 경우 방지)
    - 팀장이 아닌 팀원만 탈퇴 api에 접근 가능하다(버튼도)
    - **팀 상세 페이지**에서 탈퇴하기 버튼을 누르면 team_member table에서 삭제된다.

### 팀장 권한

---

- 🔴 팀장은 팀원에게 팀장을 위임할 수 있다.
    - 위임하면 team_member 테이블에서 팀장값을 0으로 바꾸고 위임받은 유저를 1로 바꾼다
    - 추후 해당 팀원의 수락을 받을 수도 있겠지만 여유 되면,, 합시다,,
    
- 🟢 팀장은 팀원을 팀에서 퇴출 시킬 수 있다.
    - 퇴출 버튼 클릭 시 team_reject table에 해당 user_id, team_id가 들어간다.
    - team_member table에서 해당 userId값을 삭제한다

- 🟥  팀장은 가입 신청을 수락할 수 있다.
    - 팀 상세 페이지에서 확인할 수 있다.
    - 수락을 누르면 team_member table에 row가 추가된다.
    - team_apply table에서 해당 user_id 가 삭제한다.
    
- 🔴  팀장은 가입 신청을 거절할 수 있다.
    - team_apply table에서 해당 user_id 가 삭제한다.
    - team_reject table에 해당 user_id, team_id가 들어간다.
    - 거절을 누르면 거절 테이블로 들어가서 다시 신청을 할 수 없다
    - ⚫ ****거절이나 밴 취소할 수 있는 기능도 만들면 좋을 듯

### 팀 목록

---

- 🔴  전체 팀 목록을 볼 수 있다.
    - 🟢 사용자가 소속 팀이 있는 경우 최 상단에 본인 팀 정보를 보여준다.
    - 팀 이름, 팀원 수, 주 활동 지역, 평균 연령, 스킬 점수, 랭킹을 목록에서 확인할 수 있다.
    - 목록 중 하나를 클릭하면 **팀 상세 페이지**로 이동한다.
    
- 🟡 팀원 모집 중인 팀 목록을 볼 수 있다.
    - 🟢 사용자가 소속 팀이 있는 경우 최 상단에 본인 팀 정보를 보여준다.
    - 팀 이름, 팀원 수, 주 활동 지역, 평균 연령, 스킬 점수, 랭킹을 목록에서 확인할 수 있다.
        - 팀 평균점수,팀원수,랭킹 값은 한객체에 한번에 담아 가져온다
    - 목록 중 하나를 클릭하면 **팀 상세 페이지**로 이동한다.

### 팀 정보

---

- 🟡 모든 회원은 팀 정보를 확인할 수 있다.
    - 팀 이름, 팀 로고,팀 소개 글, 연령대
    - 랭킹, 스킬 점수, 매너 점수, 팀원 수, 팀 선호 지역, 팀 선호 시간
    - 팀원 리스트
    
- 🟢 모든 회원은 팀원 목록을 확인할 수 있다.
    - 닉네임, 나이, 성별, 포지션을 확인할 수 있다.
    - 팀원을  클릭하면 해당 **회원의 상세 페이지**로 이동한다.

- ⚫ 회원 관심 팀을 즐겨 찾기 할 수 있다.

<aside>
💡 **팀 삭제 못하는거 아닌가요 (신우)
어드민아니야?(준희)**

</aside>

## 게임 관련

### 게임 등록 및 신청

---

- ❗비 로그인이나 일반 회원의 경우 경기 매치를 진행할 수 없다.
    - 비 로그인 경우, 해당 기능에 접근하면 **로그인 페이지**로 이동한다.
    - 일반 회원의 경우, 팀을 구할지 여부로 묻고, **팀원을 모집 중인 팀 목록 페이지**로 이동한다.
- 현재 매칭 시스템
    1. 등록 팀이 구장 예약 후, 매치 상대 구함.
    2. 매치 상대가 확정되면 구장 예약 비를 받음.
    - 등록 팀은 취소 시, 예약 비를 환불 후 취소할 수 있어야 함.
    - 신청 팀은 구장 예약 취소가 가능한 기간 내에 취소할 수 있어야 함.

### 게임 등록

---

- 🟥  팀원은 게임을 등록할 수 있다.
    - **게임 목록 페이지**에 등록하기 버튼이 있다.
    - 경기 정보와 참여 인원 정보를 기입한다.
        - 경기 정보: 날짜-시간(timestamp), 경기 시간, 지역 혹은 위치, 성별, 룰, 인원, 비용
        - 참여 인원 정보: 자가 진단 실력, 참여 성별, 참여 연령대, 유니폼, 한 줄 소개
    - 구인 대상 체크: 모두 미 체크 시 경고
        - 상대팀을 구합니다.
        - _명의 용병을 구합니다.
    - 등록하기 버튼 입력 시
        - game table row가 추가된다. (경기 정보, match_status, created_At )
        - awayteam table row 추가된다. (참여 인원 정보, teamId, sub_count)
    
- 🔴  해당 게임 등록자는 신청 목록 중 한 팀을 선택해 확정할 수 있다.
    - awayteam 테이블의 해당 id를 게임 테이블 awayteam_id에 기입한다.
    - match_status는 확정이 된다.

- 🟡 등록자는 확정되지 않은 게임 정보를 수정할 수 있다. 🔗api
    - 게임 날짜 및 시간, 경기 시간, 경기 지역, 경기장, vs 포맷, 성별, 룰, 비용을 수정할 수 있다.
    
- 🟡 등록자는 확정되지 않은 게임을 삭제할 수 있다. 🔗api
    1. 그냥 삭제한다.
    2. 삭제 코드를 둔다.
    

### 게임 신청

---

- 🟥  팀원은 등록 된 게임에 상대 팀으로 신청할 수 있다.
    - 신청 버튼은 **게임 상세 페이지**에 있다.
    - 본인 팀에 대한 정보를 기입한다.
        - 참여 인원 정보: 자가 진단 실력, 참여 성별, 참여 연령대, 유니폼, 한 줄 소개
    - 용병 구인 여부 체크
        - _명의 용병을 구합니다.
    - 신청하기 버튼 입력 시
        - hometeam row가 추가 된다. (gameId, teamId, 기입 정보)
    

### 게임 취소

---

- 🟢 신청 팀이 확정된 경우, 등록 팀은 상대에게 취소 요청을 할 수 있다. 🔗api
    - 삭제 요청 권한이 있는지 확인한다.
        - 확정된 용병이 있는지 확인한다.
    - 삭제 요청 테이블에 기입한다.
    - 상대 팀이 수락 시, 게임이 삭제된다.
    - 상대 팀이 거절 시, 기록이 남는다. → 어드민 혹은 신고 누적
    
- 🟢 신청 팀은 확정 후, 취소 요청을 할 수 있다. 🔗api
    - 확정된 용병이 없어야 한다.
    - 등록 팀이 수락한 경우, 게임에서 신청자 목록에서 제거 된다.
    - 🟢 등록 팀이 거절한 경우, 신고가 누적된다(no-show)
        - 혹은 신고 게시판

- 🟡 종료된 게임은 취소(삭제)가 불가능 하다.(승/무/패 기입 후) 🔗api

### 게임 종료

---

- 🟥  게임이 확정 되고, 상대 팀을 구한 경우 등록 팀은 승/무/패를 기입할 수 있다. 🔗api
    - 이미 값이 있는 경우, 승-3, 무-2, 패-1의 값을 대입해 합이 4가 되지 않으면 rollback 한다.
    - 해당 시간 내에 기입하지 않으면 rollback 한다.
        - *timeout : 트랜잭션 수행 시간이 설정 시간을 초과하면 롤백(기본값은 -1로 시간 제한 없음)*
    - 🟢 3회 이상 rollback 시, 처리 방안 고민하기
    - 성공적으로 commit 되면 team_record 테이블에 기입한다.
- 🟥  게임이 확정 되고, 상대 팀을 구한 경우 상대 팀은 승/무/패를 기입할 수 있다. 🔗api
    - 이미 값이 있는 경우 승-3, 무-2, 패-1의 값을 대입해 합이 4가 되지 않으면 rollback 한다.
    - 해당 시간 내에 기입하지 않으면 rollback 한다.
        - *timeout : 트랜잭션 수행 시간이 설정 시간을 초과하면 롤백(기본값은 -1로 시간 제한 없음)*
    - 🟢 3회 이상 rollback 시, 처리 방안 고민하기
    - 성공적으로 commit 되면 team_record 테이블에 기입한다.

### 용병 신청

---

- 🟥  모든 회원은 용병 신청을 할 수 있다. 🔗api
    - 용병을 구하고 있는 게임 상세 페이지에서 신청 가능하다.
    
- 🟥  용병 신청을 받은 팀의 팀원은 수락, 거절, 마감이 가능하다. 🔗api

### 용병 취소

---

- 🟢 수락 받은 용병은 취소 신청이 가능하다. 🔗api
    - 팀에서 취소 신청을 수락하면 해당 게임 용병 리스트에서 삭제된다.
    - 거절 시, 마이 페이지에 no-show 회원으로 작성된다.
- 🟢 용병을 모집한 경우, 팀 별 취소 요청 전 용병에게 취소 요청을 해야 한다. 🔗api
    - 모집 확정된 용병에게 취소 요청을 한다.
    - 해당 용병이 승인하면 용병 목록에서 사라 진다.
    - 거절 시, 게임 삭제가 불가하다.

### 게임 목록

---

정렬 : 경기 정보에 기입한 날짜로 한다.

경기 날짜 및 시간, 경기 지역, 인원, 성별, 룰을 출력한다.

- 🔴  상대 팀을 구하는 게임 목록을 볼 수 있다. 🔗api
    - 🟢 이 페이지에서 게임 등록하기 버튼을 누르면 상대 팀 구하기 체크 박스만 체크 되어 있다.
    - 대상: game table의 match_status가 대기 중인 row
    
- 🔴  용병이 필요한 게임 목록을 볼 수 있다. 🔗api
    - 🟢 이 페이지에서 게임 등록하기 버튼을 누르면 용병 구하기 체크 박스만 체크 되어 있다.
    - 대상: game table의 각 hometeam, awayteam의 sub_count의 합이 0 이상인 row

- 🔴  해당 팀이 참여한 게임 목록을 볼 수 있다.(팀) 🔗api
    - 대상: game table의 hometeam, awayteam의 team_id가 팀원의 team_id와 같은 row
    
- 🔴  해당 회원이 참여한 게임 목록을 볼 수 있다.(용병) 🔗api
    - 대상: sub_applicant 의 user_id가 일치하는 game_id

- 🟡 옵션
    - 날짜 별 글 목록을 볼 수 있다.
    - 지역 별 글 목록을 볼 수 있다.

### 게임 정보

---

- 🟡 모든 회원은 게임 정보를 확인할 수 있다. 🔗api
    - 게임 날짜 및 시간, 경기 시간, 경기 지역, 경기장, vs 포맷, 성별, 룰, 비용

- 🔴 모든 회원은 확정된 팀의 참여 인원 정보를 확인할 수 있다. 🔗api
    - 팀 로고, 팀 명
    - 실력, 성별, 연령, 유니폼, 한 줄 소개
    - 용병 모집 정보
    
- 🟡 확정되지 않은 경우, 신청한 팀 목록을 확인할 수 있다. 🔗api
    - 대상: awayteam table 중 해당 game_id가 있는 row

- 🟡 모든 회원은 각 팀의 확정된 용병 리스트를 확인할 수 있다. 🔗api
    - 용병 본인은 취소 버튼이 보인다.

## 랭킹 관련

### 랭킹

---

- 🟥  경기에 대한 승/무/패로 랭킹을 따질 수 있다.
    - 경기 확정 시, 승/무/패를 기입할 수 있다.
    - 승-3점, 무-2점, 패-1점
    - 기입 후 각 경기 등록자와 신청자가 모두 입력하기 버튼을 눌러야 한다.
    - 해당 경기의 상대팀과 본인 팀의 합점이 4가 되지 않으면 DB에 저장하지 않는다.
- 🟥 해당 점수로 오름차순 정렬하는 리스트를 보여준다.

## 리뷰 관련

- 🔴  게임의 승패가 결정되면 리뷰를 작성할 수 있다.

- 🔴  용병 수락을 한 회원은 용병에 대한 점수를 기재할 수 있다.
    - 경기력(skill), 태도(manner)-참여율
    - 추후 용병 랭킹 가능성인지
    
- 🔴  용병은 참여한 팀에 대한 점수를 기재할 수 있다.
    - 경기력(skill), 태도(manner)
    


🔴 🟡 🟢

## 관리자 관련

### 기능 목록

🔴 사이트 통계

🔴 매치 통계

🔴 회원 정보 리스트 및 (회원 삭제 or 회원 기능 통제)

🔴 회원들이 작성한 글 목록 관리 및 삭제 

🔴 회원들의 리뷰 

관리 및 삭제

🟢 매치 관리

🟢 공지사항 리스트 관리 및 작성, 삭제

### 메인 페이지

---

🔴  관리자 id로 로그인 해야만 관리자 페이지 접속이 가능하다

🟡 일반 회원 접속 시 접속 불가 창이 뜬다

- 🔴 메인 페이지에는 간단한 통계들이 들어간다
    - 간단한 통계는 방문자 수, 신규 회원 수, 오늘 예정된 매치 수가 들어간다
        

        

### 매치 통계 페이지

---

- 🔴  당일 매치들에 관한 한달 간 통계가 보여진다
    - 날짜와 예정된 매치 수, 취소된 매치 수, 올라온 전체 매치 글이 나타난다
        
        
    - 1일 ~31일까지 나타나며, 집계된 매치들은 다음날에 통계에 기록된다
        
        
    - 페이지에는 한달 간 통계들이 모두 나타난다
        - 이전 기록들도 달력을 통해 확인할 수 있다

### 회원 관리 페이지

---

- 🔴 모든 유저 회원 정보를 볼 수있다
    
    
    - 유저는 관리자 판단 하에 기능 통제가 가능하다
        - 유저 기능 통제는 글 등록 불가이다
        - 해체를 통해 글 등록 불가를 풀 수 있다
        - 글 등록 통제 write_blocked로 판별한다
    - 일반 회원을 관리자 권한으로 관리자로 승격 가능하다
        - 모든 관리자는 관리자 승격 권한을 가진다
        - 메인 관리자는 다른 관리자들을 일반 유저로 전환 가능하다
            - 일반 관리자끼리는 관리자 해제가 불가능하다

### 매치 글 페이지

---

🔴  매치 등록 들과 용병 등록 글을 관리하는 페이지이다

- 리스트는 당일 등록된 글들이 우선으로 나타난다
- 달력 기능을 통해 다른 날들의 글들을 관리 가능하다
- 매치 등록 글과 용병 등록 글을 삭제 할 수 있다

### 리뷰 관리 페이지

---

🔴신고 들어온 리뷰들을 관리하는 페이지이다

- 리뷰페이지에서 신고가 들어오면 관리자 리뷰 리스트에 등록된다
- 리뷰 삭제와 상세 보기가 가능하다
    - 상세 보기시 신고가 들어온 리뷰가 보여진다
- 리뷰 리스트에는 작성자/작성팀,사유,처리 상태등이 나타난다
    - 처리상태는 삭제 전이면 처리중, 삭제시 처리완료로 바뀐다
